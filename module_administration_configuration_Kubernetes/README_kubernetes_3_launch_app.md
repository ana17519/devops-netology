**Домашнее задание к занятию «Запуск приложений в K8S»**

**Цель задания**

В тестовой среде для работы с Kubernetes, установленной в предыдущем ДЗ, необходимо развернуть 
Deployment с приложением, состоящим из нескольких контейнеров, и масштабировать его.

**Чеклист готовности к домашнему заданию**

* Установленное k8s-решение (например, MicroK8S).
* Установленный локальный kubectl.
* Редактор YAML-файлов с подключённым git-репозиторием.

**Инструменты и дополнительные материалы, которые пригодятся для выполнения задания**

1. Описание [Deployment](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/) и примеры манифестов.
2. Описание [Init-контейнеров](https://kubernetes.io/docs/concepts/workloads/pods/init-containers/).
3. Описание [Multitool](https://github.com/wbitt/Network-MultiTool).

**Задание 1. Создать Deployment и обеспечить доступ к репликам приложения из другого Pod**

1. Создать Deployment приложения, состоящего из двух контейнеров — `nginx` и `multitool`. Решить возникшую ошибку.
2. После запуска увеличить количество реплик работающего приложения до 2.
3. Продемонстрировать количество подов до и после масштабирования.

[манифест](k8_yaml/deployment_task1.yaml)

![img_4.png](../images/img331.png)

4. Создать `Service`, который обеспечит доступ до реплик приложений из п.1.

![img_5.png](../images/img332.png)
![img_6.png](../images/img333.png)
![img_7.png](../images/img334.png)
![img_8.png](../images/img335.png)
![img_10.png](../images/img337.png)
![img_9.png](../images/img336.png)

5. Создать отдельный `Pod` с приложением `multitool` и убедиться с помощью `curl`, что из пода есть доступ до приложений из п.1.

![img_15.png](../images/img342.png)
![img_11.png](../images/img338.png)
![img_12.png](../images/img339.png)
![img_13.png](../images/img340.png)
![img_14.png](../images/img341.png)

**Задание 2. Создать Deployment и обеспечить старт основного контейнера при выполнении условий**

1. Создать `Deployment` приложения `nginx` и обеспечить старт контейнера только после того, как будет запущен 
сервис этого приложения.
2. Убедиться, что `nginx` не стартует. В качестве Init-контейнера взять `busybox`.
3. Создать и запустить Service. Убедиться, что Init запустился.
4. Продемонстрировать состояние пода до и после запуска сервиса.

[манифест Deployment](k8_yaml/deployment_nginx_hm3.yaml)

[манифест Service](k8_yaml/service_nginx_hm3.yaml)

![img_3.png](../images/img330.png)