**Домашнее задание к занятию "6.1. Типы и структура СУБД"**


Введение

Перед выполнением задания вы можете ознакомиться с дополнительными материалами.

**Задача 1**

**Архитектор ПО решил проконсультироваться у вас, какой тип БД лучше выбрать для хранения определенных данных.**

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

Электронные чеки в json виде - NoSQL документо-ориентированные - БД, в которой данные хранятся в виде документов. 
Каждый документ представляет данные в виде ключ-значение, связь с другими документами и мета-полями

Склады и автомобильные дороги для логистической компании - Графовые NoSQL БД, которая используют структуру графов для 
семантических запросов. Данные хранятся в виде узлов, ребер и свойств. Узел представляет собой объект. Ребро представляет 
собой отношение, которое соединяет узлы. Свойства - это дополнительная информация, добавляемая к узлам.

Генеалогические деревья - NoSQL cетевые, т.к. сетевые СУБД используют сетевую структуру для создания отношений между объектами. 
Сетевые базы данных - имеют иерархическую структуру, но в отличие от иерархических баз данных, где у одного узла может 
быть только один родительский узел, сетевой узел может иметь отношения с несколькими объектами

Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутентификации - NoSQL Column-oriented - В таких 
системах данные хранятся в виде матрицы, строки и столбцы которой используются как ключи.Типичным применением 
этого типа СУБД является веб-индексирование, а также задачи, связанные с большими данными, с пониженными требованиями 
к согласованности. Каждая строка имеет свой набор столбцов.

Отношения клиент-покупка для интернет-магазина - NoSQL Ключ-значение - База данных на основе пар «ключ‑значение» 
хранит данные как совокупность пар «ключ‑значение», в которых ключ служит уникальным идентификатором. 
Как ключи, так и значения могут представлять собой что угодно: от простых до сложных составных объектов.


Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.


<!-- СУБД можно разделить на следующие категории: 
1)Реляционные
2)Объектно-ориентированные
3) NoSQL: Иерархические, Графовые, Сетевые, Документо-ориентированные, Ключ-значение --> 


**Задача 2**

**Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно CAP-теореме. 
Какой классификации по CAP-теореме соответствует ваша система, если (каждый пункт - это отдельная реализация вашей 
системы и для каждого пункта надо привести классификацию):**


**Consistency (Согласованность, Целостность), Availability (Доступность) и 
Partition tolerance (Устойчивость к разделению)**

_Непротиворечивость — при чтении гарантированно возвращается самая последняя запись для данного клиента.
Доступность - исправный узел вернет разумный ответ в течение разумного периода времени (без ошибок или тайм-аутов).
Допуск к разделению — система будет продолжать функционировать при возникновении сетевых разделов._

**Данные записываются на все узлы с задержкой до часа (асинхронная запись)** - Partition tolerance-Availability
AP-система (Availability + Partition tolerance — Consistency) не гарантирует целостность данных, обеспечивая их доступность 
и устойчивость к разделению. 
AP. Системы данного типа отвечают на запросы, однако возвращенные данные не
всегда могут быть актуальными. 

**При сетевых сбоях, система может разделиться на 2 раздельных кластера** - Consistency-Availability
система при сетевом сбое может разделиться на два кластера - это значит, что в каждом кластере будет соблюдена доступность 
и консистентность в рамках своего кластера. 
CA (Availability + Consistency — Parition tolerance), когда данные во всех узлах кластера согласованы и доступны, 
но не устойчивы к разделению

**Система может не прислать корректный ответ или сбросить соединение** - Partition tolerance-Consistency
(PC – в случае сетевого разделения узлов системы она прекращает отвечать пользователям на запросы, данные остаются 
консистентными)
CP-система (Consistency + Partition tolerance — Availability) в каждый момент обеспечивает целостность данных и способна работать в 
условиях распада в ущерб доступности, не выдавая отклик на запрос.
CP. Системы данного типа всегда возвращают актуальные данные, однако
некоторые, или даже все, узлы системы могут не отвечать в случае разделения.


**А согласно PACELC-теореме, как бы вы классифицировали данные реализации?**

При условии наличия сетевого разделения (P)artitioning система может выбрать одно из двух: 
доступность (A)vailability или консистентность (С)onsistensy, 
иначе (E)lse, если сетевого разделения нет, система может выбрать одно из двух: 
время задержки (L)atency или консистентность (С)onsistensy. 
if P then A or C, else L or C
Latency – общее время задержки от момента выполнения действия пользователем до момента предоставления ему результата

Данные записываются на все узлы с задержкой до часа (асинхронная запись) - PA - PA/EL

При сетевых сбоях, система может разделиться на 2 раздельных кластера - CA - PA/EL
PA/EL в PACELC — при разделе они отказываются от согласованности в пользу доступности; 
и при нормальной работе они отказываются от согласованности для меньшей задержки.

Система может не прислать корректный ответ или сбросить соединение - CP - PC/EC
(PC/EC - при разделении нет доступности, при отсутствии разделения система сохраняет консистентность)


**Задача 3**

**Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?**

ACID - требования к СУБД, в обеспечение надежности и предсказуемости ее работы.

A - atomicity (атомарность) никакая транзакция не будет зафисирована в БД частично.
C - consistency (согласованность) каждая успешная транзакция фиксирует только допустимые результаты.
I - isolation (изоляция) параллельные транзакции не искажают результат друг друга.
D - durability (стойкость) гарантия применения успешных транзакций, независимо от низкоуровневых проблем.

BASE - принцип, противопоставляющий себя ACID.

BA - basically availability (базовая доступность) деградация части узлов ведет к деградации части сессий, 
исключая полную деградацию системы. Система отвечает на любой запрос, но в ответе могут быть неверные данные.
S - soft state (неустойчивое состояние) уменьшение времени хранения сессий и фиксация обновлений только критичных операций.
E - eventually consistent (конечная согласованность) изменение состояния в конечном итоге применится на все системы.

В одной системе сочетаться принципы BASE и ACID не могут, так как используют разный подход к транзакциям. 
ACID делает упор на надёжность и предсказуемость, по ACID данные должны быть согласованными.
По BASE согласованность данных является проблемой разработчика и не должна обрабатываться базой данных,
в отношении согласованности - чтобы в какой-то момент в будущем данные сходились в согласованное состояние, но без
гарантий относительно того, когда это произойдет. 


**Задача 4**

**Вам дали задачу написать системное решение, основой которого бы послужили:**

фиксация некоторых значений с временем жизни
реакция на истечение таймаута

Вы слышали о key-value хранилище, которое имеет механизм Pub/Sub. 
Что это за система? Какие минусы выбора данной системы?

По лекции это Redis - это СУБД вида “ключ-значение”.

Основные характеристики системы:

●Может использоваться как БД, так и как кэш-система или брокер сообщений.

●Все данные хранятся в оперативной памяти.

●Данным можно присваивать Time-To-Live.

●Имеется встроенная система Pub/Sub.

●Поддерживает Master-Slave репликацию.


Pub/sub — механизм, который позволяет, с одной стороны, подписаться на канал и получать сообщения из него, 
с другой стороны — отправлять в этот канал сообщение, которое будет получено всеми подписчиками.

Минусы выбора системы:

Механизм pub/sub не гарантирует доставки сообщений, он не гарантирует консистентности, поэтому не стоит его 
использовать в системах, для которых важны эти критерии. 
